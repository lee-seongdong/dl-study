# CNN
이미지나 음성 등 형상을 가진 데이터를 이해할 수 있는 네트워크  
완전 연결계층으로만 이루어진 네트워크는 데이터의 형상이 무시되어, 이를 제대로 학습할 수 없음  

## CNN의 구조
1개 이상의 Conv-ReLU-(Pooling) 계층 조합으로 구성됨

## 합성곱 연산 (Convolution)
- `입력 데이터`를 `필터(커널)`이 순회하며 `단일 곱셈-누산`을 진행
- `단일 곱셈-누산` 결과에 `편향(스칼라)`을 더해 `출력`

### 합성곱 크기
2차원
- 입력 크기: (H, W)
- 필터 크기: (FH, FW)
- 출력 크기: (OH, OW)

3차원, 필터 1개
- 입력 크기: (C, H, W) -> H, W에 채널 C까지 고려한 3차원 데이터
- 필터 크기: (C, FH, FW) -> 필터의 채널 크기는 입력의 채널과 동일
- 출력 크기: (1, OH, OW) -> 2차원 데이터

3차원, 필터 FN개
- 입력 크기: (C, H, W)
- 필터 크기: (FN, C, FH, FW)
- 편향: (FN, 1, 1)
- 출력 크기: (FN, OH, OW)

배치 처리
- 입력 크기: (N, C, H, W)
- 필터 크기: (FN, C, FH, FW)
- 편향: (FN, 1, 1)
- 출력 크기: (N, FN, OH, OW)

### 합성곱 계층의 출력 크기 계산
- 입력 크기: (H, W)
- 필터 크기: (FH, FW)
- 패딩: P
- 스트라이드: S
- 출력 크기: (OH, OW)

> 출력의 크기는 `패딩`과 `스트라이드`로 조절
> - 패딩: 입력 데이터 주변을 특정 값으로 채우는 기법 (출력 크기 커짐) -> 출력 크기가 1로 수렴하는것을 방지
> - 스트라이드: 필터가 이동하는 간격을 설정하는 기법 (출력 크기 작아짐)
> - OH = (H + 2P - FH) / S + 1  
> - OW = (W + 2P - FW) / S + 1

## 풀링 (Pooling)
데이터의 크기를 줄이는 연산 기법
- 풀링 윈도우의 크기와 스트라이드는 같은값으로 설정하는것을 권장(윈도우가 겹치지 않도록)
- 여러 풀링방법이 있지만, 일반적으로 `최대풀링`을 사용

### 풀링 계층의 특징
- 학습할 매개변수가 없음
- 데이터 채널의 변화를 주지 않음
- 입력 데이터 변화에 영향을 적게 받음
